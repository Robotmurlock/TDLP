defaults:
  - the_global_config
  - _self_

experiment_name: exp107a-fromExp105-ScaleUp
dataset_name: DanceTrack
resources:
  batch_size: 32
  accelerator: cuda:0
  num_workers: 20
  val_batch_size: 16
dataset:
  index:
    type: mot
    params:
      paths:
      - /media/home/DanceTrack-orig/
    sequence_list: null
  n_tracks: 40
  clip_length: 50
  min_clip_tracks: 1
  clip_sampling_step: 1
  val_clip_sampling_step: 1
  feature_extractor:
    extractor_type: pred_bbox
    extractor_params:
      prediction_path: /media/home/cameltrack-states/extracted-features
      extra_false_positives: true
      feature_names:
      - appearance
      random_appearance_jitter_ratio: 0.0
      random_appearance_jitter_range: 0
  transform:
    _target_: tdlp.datasets.dataset.transform.ComposeTransform
    transforms:
    - _target_: tdlp.datasets.dataset.transform.BBoxXYWHtoXYXY
    - _target_: tdlp.datasets.dataset.transform.BBoxMinMaxScaling
    - _target_: tdlp.datasets.dataset.transform.FeatureFODStandardization
      coord_mean:
        bbox:
        - 0.5
        - 0.5
        - 0.5
        - 0.5
        - 0.5
        keypoints:
        - - 35
          - - 0.5
      coord_std:
        bbox:
        - 0.1
        - 0.1
        - 0.1
        - 0.1
        - 1.0
        keypoints:
        - - 17
          - - 0.1
            - 0.1
        - 1.0
      fod_mean:
        bbox:
        - 0.0
        - 0.0
        - 0.0
        - 0.0
        - 0.0
        keypoints:
        - - 35
          - - 0.0
      fod_std:
        bbox:
        - 0.05
        - 0.05
        - 0.05
        - 0.05
        - 1.0
        keypoints:
        - - 17
          - - 0.05
            - 0.05
        - 1.0
      fod_time_scaled: true
  augmentations:
    _target_: tdlp.datasets.dataset.augmentations.base.CompositionAugmentation
    augmentations:
    - _target_: tdlp.datasets.dataset.augmentations.bbox.BBoxGaussianNoiseAugmentation
      sigma: 0.05
      proba: 0.4
      unobs_noise: true
    - _target_: tdlp.datasets.dataset.augmentations.bbox.BBoxGaussianNoiseAugmentation
      sigma: 0.1
      proba: 0.1
      unobs_noise: true
    - _target_: tdlp.datasets.dataset.augmentations.bbox.BBoxGaussianNoiseAugmentation
      sigma: 0.25
      proba: 0.05
      unobs_noise: true
    - _target_: tdlp.datasets.dataset.augmentations.video.PointOcclusionAugmentations
      drop_ratio: 0.3
    - _target_: tdlp.datasets.dataset.augmentations.video.LeftOrRightOcclusionAugmentations
      drop_ratio: 0.2
    - _target_: tdlp.datasets.dataset.augmentations.video.IdentitySwitchAugmentation
      switch_ratio: 0.3
    - _target_: tdlp.datasets.dataset.augmentations.appearance.AppearanceNoiseAugmentation
      alpha: 0.4
    - _target_: tdlp.datasets.dataset.augmentations.video.SmartIdentitySwitchAugmentation
      switch_ratio: 0.5
      iou_threshold: 0.5
      max_switch_ratio: 0.5
  sampler: null
  use_batch_sampler: false
train:
  max_epochs: 20
  loss_config:
    _target_: tdlp.trainer.losses.bce.ClipLevelBCE
    pos_weight: 10.0
    assoc_threshold: 0.01
  optimizer_config:
    _target_: torch.optim.AdamW
    lr: 5.0e-05
    weight_decay: 0.01
  scheduler_config:
    _target_: tdlp.trainer.scheduler.create_warmup_cosine_annealing_scheduler
    n_warmup_epochs: 2
  gradient_clip: 1.0
  mixed_precision: true
  resume: false
  truncate: true
  checkpoint_cfg:
    metric_monitor: val-epoch/loss
    resume_from: null
model_config:
  _target_: tdlp.architectures.tdlp.core.build_mm_tdsp_model
  mm_dim: 1024
  similarity_prediction_head_hidden_dim: 512
  sph_common_params:
    hidden_dim: 512
  sph_per_feature_params:
    appearance:
      hidden_dim: 512
  common_params:
    hidden_dim: 256
    dropout: 0.1
    track_encoder_n_heads: 8
    track_encoder_n_layers: 4
    track_encoder_ffn_dim: 512
    projector_intermediate_dim: 512
    interaction_encoder_enable: true
    interaction_encoder_n_heads: 8
    interaction_encoder_n_layers: 4
    interaction_encoder_ffn_dim: 512
  per_feature_params:
    appearance:
      hidden_dim: 512
      feature_encoder_type: parts_appearance
      feature_encoder_params:
        emb_size: 128
        hidden_dim: 512
      track_encoder_enable_motion_encoder: false
      track_encoder_ffn_dim: 1024
      interaction_encoder_ffn_dim: 1024
  aggregator_type: sum
  aggregator_params: {}
path:
  master: /media/home/MOT-JEPA-outputs
eval:
  object_detection:
    type: yolox
    params:
      accelerator: cuda:0
      conf: 0.6
      min_bbox_area: 100
      model_path: /media/home/DanceTrack-orig/.other/bytetrack_models/bytetrack_model.pth.tar
    lookup_path: /media/home/DanceTrack-orig/.other/.lookup.json
    cache_path: /workspace/motrack/dancetrack_yolox
    oracle: false
  tracker:
    remember_threshold: 50
    detection_threshold: 0.4
    sim_threshold: 0.90
    initialization_threshold: 1
    new_tracklet_detection_threshold: 0.9
  split: val
  checkpoint: null
  visualize: false
  postprocess_enable: true
analysis: null
